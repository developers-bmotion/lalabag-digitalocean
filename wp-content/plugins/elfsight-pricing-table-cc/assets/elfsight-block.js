/*
    Elfsight Pricing Table
    Version: 2.5.1
    Release date: Tue Aug 13 2019

    https://elfsight.com

    Copyright (c) 2019 Elfsight, LLC. ALL RIGHTS RESERVED
*/

!function(wp,$){"use strict";let IconBlock=function(e){return wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"20",height:"20",viewBox:"0 0 20 20",class:"dashicon"},[wp.element.createElement("path",{id:"a",d:"M11.843 1.923a3.272 3.272 0 0 1 3.264 3.264v9.45c0 1.797-.931 3.265-2.728 3.265H8.157a3.272 3.272 0 0 1-3.264-3.264v-9.45a3.272 3.272 0 0 1 3.264-3.265h3.686zm1.89 12.56h-.006V5.341a2.046 2.046 0 0 0-2.038-2.037H8.311c-1.12 0-2.038.918-2.038 2.037v9.142c0 1.12.919 2.038 2.038 2.038h3.92c1.12 0 1.502-.918 1.502-2.038zm3.003-11.22A3.272 3.272 0 0 1 20 6.529v6.77a3.272 3.272 0 0 1-3.264 3.263h-1.052c.295-.402.429-.871.516-1.38h.388c1.12 0 2.038-.919 2.038-2.038h-.007V6.682c0-1.12-.918-2.038-2.037-2.038H16.2c-.087-.51-.221-.978-.516-1.38h1.052zm-13.472 0h1.052c-.295.403-.429.872-.516 1.381h-.382c-1.12 0-2.037.918-2.037 2.038v6.46h-.007c0 1.12.918 2.038 2.038 2.038H3.8c.087.51.221.979.516 1.381H3.264A3.272 3.272 0 0 1 0 13.297v-6.77a3.272 3.272 0 0 1 3.264-3.263zm7.024 3.03v1.039c.248.027.456.074.63.147.174.074.329.188.456.342.1.12.181.235.241.355a.84.84 0 0 1 .08.336.41.41 0 0 1-.422.416c-.227 0-.368-.122-.435-.363a.768.768 0 0 0-.543-.57v1.421c.281.074.51.148.677.215.167.06.315.16.449.275.14.127.248.274.328.449.074.174.114.368.114.576a1.469 1.469 0 0 1-.717 1.287c-.234.14-.523.228-.844.255v1.018c0 .134-.047.322-.215.322-.08 0-.14-.027-.174-.074-.034-.053-.054-.06-.054-.167v-1.093a2.349 2.349 0 0 1-.704-.187 1.777 1.777 0 0 1-.502-.356 1.592 1.592 0 0 1-.295-.442c-.06-.154-.1-.308-.1-.456a.41.41 0 0 1 .127-.295.44.44 0 0 1 .321-.134.48.48 0 0 1 .262.074.37.37 0 0 1 .147.201c.06.188.12.335.161.43.047.1.114.187.208.267.094.08.214.141.369.188v-1.582a4.744 4.744 0 0 1-.771-.281 1.233 1.233 0 0 1-.503-.443c-.127-.187-.188-.442-.188-.744 0-.395.121-.717.376-.965.254-.248.616-.402 1.086-.442V6.28c0-.188.073-.289.214-.289.147.02.221.114.221.302zm-.435 3.023V8.002a1.176 1.176 0 0 0-.45.228c-.107.094-.16.235-.16.422 0 .181.053.315.147.41.1.093.255.173.463.254zm.435 1.019v1.5c.228-.046.41-.14.53-.274a.7.7 0 0 0 .187-.49c0-.2-.06-.354-.18-.462-.121-.114-.296-.2-.537-.274z"})])};if(void 0===wp.components||void 0===wp.blocks||void 0===wp.element||void 0===wp.i18n)return!1;const{__:__}=wp.i18n,el=wp.element.createElement,registerBlockType=wp.blocks.registerBlockType,ServerSideRender=wp.components.ServerSideRender;let initTimeout;function initWidget(){clearTimeout(initTimeout),initTimeout=setTimeout(function(){let widgets=document.querySelectorAll("[data-elfsight-pricing-table-options]");Array.prototype.slice.call(widgets).forEach(function(widget){let options=widget.getAttribute("data-elfsight-pricing-table-options"),data=JSON.parse(decodeURIComponent(options));eval("eappsPricingTable(widget, data)"),widget.removeAttribute("data-elfsight-pricing-table-options"),widget.removeAttribute("data-elfsight-pricing-table-version"),widget.closest(".elfsight-block-widget-container").classList.add("elfsight-block-widget-initialized")})},1500)}async function getWidgets(){const e=await $.get(ajaxurl,{action:"elfsight-pricing-table".replace(/-/g,"_")+"_widgets_api",endpoint:"list"});return e.status?[e.data,e.data.reduce(function(e,t){return e[t.id]=t,e},{})]:[]}function getWidgetId(e){let t;return e.some(function(e){if("1"===e.active)return t=e.id}),t}class Widget extends React.Component{componentDidMount(){initWidget()}componentDidUpdate(){initWidget()}render(){return this.props.id?el("div",{className:"elfsight-block-widget-container"},el(ServerSideRender,{block:"elfsight-pricing-table/block",attributes:{id:this.props.id||"1"}}),el("div",{className:"elfsight-block-widget-placeholder"},el(IconBlock,{}),el("span",{},"Elfsight Pricing Table"))):[]}}class Button extends React.Component{render(){let e=document.location.origin+document.location.pathname.replace("post.php","admin.php")+"?page=elfsight-pricing-table#";return el("a",{href:e+this.props.href,target:"_blank",className:this.props.className},this.props.text)}}class WidgetSelect extends React.Component{constructor(){super(),this.state={widgets:[]}}setWidget(e){e.preventDefault();let t=e.target.querySelector("option:checked");this.props.setAttributes({id:t.value.toString()})}componentDidMount(){getWidgets().then(e=>{const[t,i]=e;this.setState({widgets:t});const s=this.props.id,l=!(!i[s]||"1"!==i[s].active);!l&&i?this.props.setAttributes({id:getWidgetId(t),exist:!0}):this.props.setAttributes({id:s,exist:l})})}render(){return this.state.widgets.length>0?el("div",{className:"components-base-control"},el("div",{className:"components-base-control__field"},el("select",{className:"components-select-control__input",id:"elfsight-pricing-table-block-control-id",value:this.props.id,onChange:this.setWidget.bind(this)},this.state.widgets.map(e=>wp.element.createElement("option",{value:e.id},[e.name]))))):[]}}registerBlockType("elfsight-pricing-table/block",{title:"Elfsight Pricing Table",description:"Help your customers make a purchase with a clear and graphic pricing",icon:{src:IconBlock},category:"widgets",keywords:["Elfsight Pricing Table","Elfsight"],supports:{html:!1},attributes:{id:{type:"number"},exist:{type:"bool",default:!1}},edit:function(e){const{attributes:{id:t,exist:i},setAttributes:s}=e;return getWidgets().then(e=>{const[l,n]=e;s(!i&&l?{id:getWidgetId(l),exist:!0}:{id:t,exist:i})}),el(wp.element.Fragment,{},el(wp.editor.InspectorControls,{},el(wp.components.PanelBody,{className:"elfsight-block-panel",title:"Select widget"},el(WidgetSelect,{id:t,setAttributes:function(t){e.setAttributes(t)}}),i?el("div",{className:"elfsight-block-panel-group"},el(Button,{href:"/edit-widget/"+t,className:"components-button is-button is-default is-large elfsight-block-panel-button",text:__("Edit Widget")}),el(Button,{href:"/add-widget/",className:"elfsight-block-panel-link",text:__("Create new widget")})):el("div",{className:"elfsight-block-panel-group"},el("span",{},__("No widgets yet")),el(Button,{href:"/add-widget/",className:"components-button is-button is-default is-primary is-large elfsight-block-panel-button",text:__("Create Widget")})))),i?el(Widget,{id:t,exist:i}):null,i?null:el("div",{className:"elfsight-block-form"},el("div",{className:"elfsight-block-form-header"},el(IconBlock,{}),el("span",{},"Elfsight Pricing Table")),el("div",{className:"elfsight-block-form-text"},__("Help your customers make a purchase with a clear and graphic pricing"),el("br"),el("strong",{},__("Let's create your first widget!"))),el(Button,{href:"/add-widget/",className:"components-button is-button is-default is-primary is-large elfsight-block-form-button",text:__("Create Widget")})))},save:function(){return null}})}(wp,jQuery);